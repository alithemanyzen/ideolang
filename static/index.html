<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>ideolang</title>
        <script src="/editor/model.js" charset="utf-8"></script>
        <script src="/editor/canvas.js" charset="utf-8"></script>


        <link rel="stylesheet" href="style.css" media="screen" title="no title" charset="utf-8">
        <script src="//cdnjs.cloudflare.com/ajax/libs/mithril/0.2.3/mithril.min.js"></script>
    </head>
    <body>
        <div id="content">
            This site requires javascript.
        </div>

        <script src="characterview.js" charset="utf-8"></script>
        <script src="main.js" charset="utf-8"></script>

        <!--
        <script type="text/javascript">
            function newChar(){
                var input = document.getElementById("newChar");
                var val = input.value;
                val = val.toLowerCase();
                window.location.assign("/edit/"+val);
            }
        </script>

        <script type="text/javascript">

            function loadChars(chars){
                var container = document.getElementById("characters");
                for(var i in chars){
                    var charElem = document.createElement("div")
                    var name = document.createElement("a");
                    name.setAttribute('href', '/edit/'+chars[i].name);
                    name.innerHTML = chars[i].name;
                    charElem.setAttribute('class', 'characterBlock');

                    var canvas = document.createElement("canvas");
                    canvas.setAttribute('width', 80);
                    canvas.setAttribute('height', 80);
                    content.appendChild(canvas);

                    ctx = canvas.getContext("2d");
                    ctx.translate(0.5,0.5);


                    //lines
                    var s = 5;
                    ctx.lineWidth= s*0.75;
                    ctx.lineJoin = 'round';
                    ctx.lineCap = 'round';
                    ctx.strokeStyle = '#333333';

                    var points = chars[i].value.points;
                    for(var j in chars[i].value.lines){
                        var line = chars[i].value.lines[j];
                        console.log(line);
                        var a = [points[line[0]][0], points[line[0]][1]];
                        var b = [points[line[1]][0], points[line[1]][1]];


                        ctx.beginPath();
                            ctx.moveTo(a[0]*s+10, a[1]*s+10);
                            ctx.lineTo(b[0]*s+10, b[1]*s+10);
                        ctx.stroke();

                    }

                    if(chars[i].value.lines.length==0){
                        ctx.beginPath();
                            ctx.moveTo(6*s+10, 4*s+10);
                            ctx.lineTo(6*s+10, 8*s+10);
                        ctx.stroke();

                        ctx.beginPath();
                            ctx.moveTo(4*s+10, 6*s+10);
                            ctx.lineTo(8*s+10, 6*s+10);
                        ctx.stroke();
                    }

                    charElem.appendChild(canvas);
                    charElem.appendChild(name);

                    container.appendChild(charElem);
                }
            }

            var xmlhttp = new XMLHttpRequest();
            var url = "/characters";

            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    if(xmlhttp.responseText){
                        var myArr = JSON.parse(xmlhttp.responseText);
                        loadChars(myArr);
                    }
                }
            };

            xmlhttp.open("GET", url, true);
            xmlhttp.send();
        </script>
    </body>
-->
</html>
